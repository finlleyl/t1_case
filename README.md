# OCR –¥–ª—è —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

![Python](https://img.shields.io/badge/python-3.8%2B-blue) ![Docker](https://img.shields.io/badge/docker-supported-lightgrey) ![License: MIT](https://img.shields.io/badge/license-MIT-green)

## üéØ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ (OCR) –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Ä—É–∫–æ–ø–∏—Å–Ω—ã–π –≤–≤–æ–¥. –ü–æ–∑–≤–æ–ª—è–µ—Ç:

- –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ (YOLOv8).
- –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫–∏ –∫–∞–∫ —Ä—É–∫–æ–ø–∏—Å–Ω—ã–µ –∏–ª–∏ –ø–µ—á–∞—Ç–Ω—ã–µ (CLIP).
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ bbox (TrOCR).
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Ö–æ–¥ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏ —Ç–µ–∫—Å—Ç–æ–º.
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Streamlit UI –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI.


## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞**: YOLOv8, fine-tuned –Ω–∞ —Ä—É–∫–æ–ø–∏—Å–∏, F1‚âà92.7%, latency‚âà100‚ÄØms.
- **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ**: TrOCR (`raxtemur/trocr-base-ru`), –¥–æ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –∞–Ω–∫–µ—Ç–∞—Ö.
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: CLIP-model –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ä—É–∫–æ–ø–∏—Å–Ω–æ–≥–æ –∏ –ø–µ—á–∞—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.
- **API**: FastAPI —ç–Ω–¥–ø–æ–∏–Ω—Ç `/ocr` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∏—Å—Ç–µ–º—ã.
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: –≥–æ—Ç–æ–≤—ã–π Dockerfile –∏ `docker-compose`.


## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/your_org/ocr-bank-docs.git
   cd ocr-bank-docs
   ```
2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   python3 -m venv .venv
   source .venv/bin/activate
   pip install -r requirements.txt
   ```
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ editable-—Ä–µ–∂–∏–º–µ:
   ```bash
   pip install -e .
   ```


## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ API

```bash
uvicorn src.ocr_bank_docs.api:app --host 0.0.0.0 --port 8000
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST "http://localhost:8000/ocr" \   
     -F "image=@/path/to/image.jpg" | jq
```

### Streamlit UI

```bash
streamlit run src/ocr_bank_docs/ui/app.py
```


## üê≥ Docker

1. –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑:
   ```bash
   docker build -t ocr-bank-docs:latest .
   ```
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
   ```bash
   docker run --rm -p 8000:8000 ocr-bank-docs:latest
   ```


## ‚öôÔ∏è –ü–∞–π–ø–ª–∞–π–Ω

1. **Detection**: `src/ocr_bank_docs/detection/inference.py`
2. **Classification**: —Ç–µ –∂–µ bbox ‚Üí CLIP —Ñ–∏–ª—å—Ç—Ä —Ä—É—á–Ω–æ–≥–æ/–ø–µ—á–∞—Ç–Ω–æ–≥–æ.
3. **Recognition**: `src/ocr_bank_docs/pipelines/run_pipeline.py` (TrOCR).
4. **Output**: JSON –≤–∏–¥–∞:
   ```json
   {
     "bbox": {"x": 50.0, "y": 80.0, "width": 250.0, "height": 40.0},
     "text": "–ü—Ä–∏–º–µ—Ä"
   }
   ```


## üìä –ë–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

- **–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞**: `scripts/benchmark.py` ‚Äî –º–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –∏ —Å—Ä–µ–¥–Ω—é—é latency.
- **–ú–µ—Ç—Ä–∏–∫–∏**: WER –∏ CER —Å—á–∏—Ç–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `scripts/evaluate.py`.
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**: —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä ‚Äî 10‚Äì20 —Å–∫–∞–Ω–æ–≤, –∑–∞–º–µ—Ä—ã latency ‚â§‚ÄØ1‚ÄØs –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç.


## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ocr-bank-docs/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ ocr_bank_docs/
‚îÇ       ‚îú‚îÄ‚îÄ api/         # FastAPI endpoints
‚îÇ       ‚îú‚îÄ‚îÄ detection/   # YOLO-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ pipelines/   # –û—Å–Ω–æ–≤–Ω–æ–π pipeline run_pipeline.py
‚îÇ       ‚îî‚îÄ‚îÄ ui/          # Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ benchmark.py
‚îÇ   ‚îî‚îÄ‚îÄ evaluate.py
‚îú‚îÄ‚îÄ test_datasets/       # –ü—Ä–∏–º–µ—Ä–Ω—ã–µ —Å–∫–∞–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```


## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã



–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

FastAPI ‚Äì REST API –¥–ª—è –ø—Ä–∏—ë–º–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤—ã–¥–∞—á–∏ JSON-–æ—Ç–≤–µ—Ç–æ–≤.

Streamlit UI ‚Äì –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏.

Detection Module ‚Äì YOLOv8, fine-tuned –Ω–∞ —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–∞—Ö, –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ –∏ –∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.

Classification Module ‚Äì CLIP-–º–æ–¥–µ–ª—å —Ä–∞–∑–¥–µ–ª—è–µ—Ç —Ä—É–∫–æ–ø–∏—Å–Ω—ã–π –∏ –ø–µ—á–∞—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ bbox.

Recognition Module ‚Äì TrOCR (raxtemur/trocr-base-ru), –¥–æ–æ–±—É—á–µ–Ω–Ω—ã–π –Ω–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –∞–Ω–∫–µ—Ç–∞—Ö, —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ç–µ–∫—Å—Ç.

Orchestration ‚Äì –µ–¥–∏–Ω—ã–π pipeline (run_pipeline.py) –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —à–∞–≥–∏, —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—á–µ—Ä–µ–¥—å—é –∑–∞–¥–∞—á –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫—É.

<img src="ML_arch.drawio.png">

<img src="container.png">

## ‚öôÔ∏è –ü–∞–π–ø–ª–∞–π–Ω

‚öôÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞



–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª —á–µ—Ä–µ–∑ API –∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –≤ Streamlit UI.


Detection

YOLOv8 –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç bbox (x, y, width, height).

Classification

–î–ª—è –∫–∞–∂–¥–æ–≥–æ bbox CLIP-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Ä—É–∫–æ–ø–∏—Å–Ω—ã–π —ç—Ç–æ —Ç–µ–∫—Å—Ç –∏–ª–∏ –ø–µ—á–∞—Ç–Ω—ã–π.

Recognition

–í—ã—Ä–µ–∑–∫–∞ ROI –ø–æ bbox –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –≤ TrOCR. –ü–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ –µ–≥–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.

Output

–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON-–æ—Ç–≤–µ—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

<img src="pipeline.png">

<img src="sequence.png">


## üìö –î–∞–Ω–Ω—ã–µ –∏ –¥–æ–æ–±—É—á–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã:

- [Russian Handwritten Letters (Kaggle)](https://www.kaggle.com/datasets/olgabelitskaya/handwritten-russian-letters)
- [Cyrillic Handwriting (Kaggle)](https://www.kaggle.com/datasets/constantinwerner/cyrillic-handwriting-dataset)
- [HWR200 (Hugging Face)](https://huggingface.co/datasets/AntiplagiatCompany/HWR200)
- [Russian Handwritten Text(for detection)](https://universe.roboflow.com/max-kuznetsov/russian-handwritten-text)
